model User {
  id         Int     @id @default(autoincrement())
  avatar     String?
  name       String
  phone      String  @unique
  email      String  @unique
  password   String
  role_id    Int
  company_id Int
  company    Company @relation(fields: [company_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  role       Role    @relation(fields: [role_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@map("user")
  @@schema("rbac")
}

model Module {
  id          Int          @id @default(autoincrement())
  name        String
  code        String       @unique
  route       String       @unique
  role_module RoleModule[]

  @@map("module")
  @@schema("rbac")
}

model Role {
  id          Int          @id @default(autoincrement())
  name        String
  code        String       @unique
  role_module RoleModule[]
  users       User[]

  @@map("role")
  @@schema("rbac")
}

model RoleModule {
  id         Int                @id @default(autoincrement())
  role_id    Int
  module_id  Int
  permission permission_type[]  @default([read, create])
  module     Module             @relation(fields: [module_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  role       Role               @relation(fields: [role_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@map("role_module")
  @@schema("rbac")
  @@unique([role_id, module_id])
}

enum permission_type {
  read
  create
  update
  delete

  @@schema("rbac")
}